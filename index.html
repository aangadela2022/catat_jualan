<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Catat Jualan - Pedagang Keliling (Cloud Storage)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lucide/0.263.0/lucide.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously, signInWithCustomToken, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, doc, setDoc, getDoc, collection, query, onSnapshot, addDoc, updateDoc, deleteDoc, Timestamp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        const firebaseConfig = JSON.parse(__firebase_config);
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';

        let currentUser = null;
        let products = [];
        let stores = [];
        let sales = [];
        let purchases = []; 
        let currentTransactionItems = [];
        
        let editingStoreId = null;
        let editingProductId = null;

        function safeCreateIcons() {
            if (typeof lucide !== 'undefined') {
                lucide.createIcons();
            }
        }

        const initAuth = async () => {
            try {
                if (typeof __initial_auth_token !== 'undefined' && __initial_auth_token) {
                    await signInWithCustomToken(auth, __initial_auth_token);
                } else {
                    await signInAnonymously(auth);
                }
            } catch (error) {
                console.error("Auth Error:", error);
            }
        };

        onAuthStateChanged(auth, (user) => {
            currentUser = user;
            if (user) {
                setupFirestoreListeners(user.uid);
                const displayEl = document.getElementById('user-id-display');
                if (displayEl) displayEl.innerText = `ID: ${user.uid}`;
            }
        });

        function setupFirestoreListeners(userId) {
            const storesRef = collection(db, 'artifacts', appId, 'users', userId, 'stores');
            const productsRef = collection(db, 'artifacts', appId, 'users', userId, 'products');
            const salesRef = collection(db, 'artifacts', appId, 'users', userId, 'sales');
            const purchasesRef = collection(db, 'artifacts', appId, 'users', userId, 'purchases');

            onSnapshot(storesRef, (snapshot) => {
                stores = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
                renderStores();
                updateDropdowns();
            });

            onSnapshot(productsRef, (snapshot) => {
                products = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
                renderProducts();
                updateDropdowns();
            });

            onSnapshot(salesRef, (snapshot) => {
                sales = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }))
                    .sort((a, b) => (b.timestamp?.seconds || 0) - (a.timestamp?.seconds || 0));
                renderSales();
                renderProfitReport();
                updateStats();
            });

            onSnapshot(purchasesRef, (snapshot) => {
                purchases = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }))
                    .sort((a, b) => (b.timestamp?.seconds || 0) - (a.timestamp?.seconds || 0));
                renderPurchases();
            });
        }

        window.switchTab = (tabId) => {
            document.querySelectorAll('.tab-content').forEach(tab => tab.classList.remove('active'));
            document.getElementById('tab-' + tabId).classList.add('active');
            document.querySelectorAll('.nav-btn').forEach(btn => {
                if(btn.dataset.tab === tabId) btn.classList.add('nav-active');
                else btn.classList.remove('nav-active');
            });
            safeCreateIcons();
        };

        // --- MANAJEMEN PEMBELIAN ---
        window.handlePurchaseSubmit = async (e) => {
            e.preventDefault();
            if (!currentUser) return;
            const productId = document.getElementById('buy-product').value;
            const qty = parseInt(document.getElementById('buy-qty').value);
            const hargaBeliUnit = parseInt(document.getElementById('buy-price').value);
            if (!productId || !qty || !hargaBeliUnit) return;
            const product = products.find(p => p.id === productId);
            await addDoc(collection(db, 'artifacts', appId, 'users', currentUser.uid, 'purchases'), {
                productId, productName: product.nama, qty, hargaBeliUnit, total: qty * hargaBeliUnit, timestamp: Timestamp.now()
            });
            await updateDoc(doc(db, 'artifacts', appId, 'users', currentUser.uid, 'products', productId), { hargaBeli: hargaBeliUnit });
            document.getElementById('form-pembelian').reset();
            showToast("Pembelian stok dicatat!");
        };

        function renderPurchases() {
            const tbody = document.getElementById('table-pembelian-body');
            if (!tbody) return;
            tbody.innerHTML = purchases.length ? '' : '<tr><td colspan="6" class="text-center py-6 text-gray-400 italic">Belum ada riwayat pembelian</td></tr>';
            purchases.forEach(p => {
                const date = p.timestamp?.toDate() ? p.timestamp.toDate().toLocaleDateString('id-ID') : '-';
                tbody.innerHTML += `
                    <tr class="border-b hover:bg-gray-50">
                        <td class="px-4 py-3">${date}</td>
                        <td class="px-4 py-3 font-bold text-gray-800">${p.productName}</td>
                        <td class="px-4 py-3 text-center">${p.qty}</td>
                        <td class="px-4 py-3 text-right">Rp ${p.hargaBeliUnit.toLocaleString('id-ID')}</td>
                        <td class="px-4 py-3 text-right font-bold text-blue-600">Rp ${p.total.toLocaleString('id-ID')}</td>
                        <td class="px-4 py-3 text-center">
                             <button onclick="deletePurchase('${p.id}')" class="text-red-300 hover:text-red-500"><i data-lucide="trash-2" size="14"></i></button>
                        </td>
                    </tr>`;
            });
            safeCreateIcons();
        }

        window.deletePurchase = async (id) => {
            if (!currentUser || !confirm("Hapus catatan pembelian ini?")) return;
            await deleteDoc(doc(db, 'artifacts', appId, 'users', currentUser.uid, 'purchases', id));
        };

        // --- MANAJEMEN PENJUALAN ---
        window.addItemToTransaction = (e) => {
            e.preventDefault();
            const productId = document.getElementById('select-produk').value;
            const qty = parseInt(document.getElementById('input-qty').value) || 0;
            const retur = parseInt(document.getElementById('input-retur').value) || 0;
            if (!productId || (qty === 0 && retur === 0)) return;
            const product = products.find(p => p.id === productId);
            currentTransactionItems.push({ 
                productId, 
                nama: product.nama, 
                qty, 
                retur, 
                harga: product.harga, 
                hargaBeli: product.hargaBeli || 0,
                subtotal: (qty - retur) * product.harga 
            });
            renderTransactionPreview();
            document.getElementById('input-qty').value = '';
            document.getElementById('input-retur').value = '';
        };

        function renderTransactionPreview() {
            const container = document.getElementById('transaction-preview');
            const tbody = document.getElementById('preview-body');
            if (currentTransactionItems.length === 0) {
                container.classList.add('hidden');
                return;
            }
            container.classList.remove('hidden');
            tbody.innerHTML = '';
            currentTransactionItems.forEach((item, index) => {
                tbody.innerHTML += `
                    <tr class="border-b">
                        <td class="p-2">${item.nama}</td>
                        <td class="p-2 text-center">${item.qty} | ${item.retur}</td>
                        <td class="p-2 text-right">Rp ${item.subtotal.toLocaleString('id-ID')}</td>
                        <td class="p-2 text-center"><button onclick="removeItem(${index})" class="text-red-500">Ã—</button></td>
                    </tr>`;
            });
        }

        window.removeItem = (index) => {
            currentTransactionItems.splice(index, 1);
            renderTransactionPreview();
        };

        window.submitTransaction = async () => {
            const storeId = document.getElementById('select-toko').value;
            if (!storeId || currentTransactionItems.length === 0) return;
            const store = stores.find(s => s.id === storeId);
            const totalOmzet = currentTransactionItems.reduce((sum, item) => sum + item.subtotal, 0);
            
            await addDoc(collection(db, 'artifacts', appId, 'users', currentUser.uid, 'sales'), {
                storeId,
                storeName: store.nama,
                items: currentTransactionItems,
                totalOmzet,
                timestamp: Timestamp.now()
            });
            
            currentTransactionItems = [];
            renderTransactionPreview();
            document.getElementById('select-toko').value = '';
            showToast("Penjualan berhasil disimpan!");
        };

        function renderSales() {
            const tbody = document.getElementById('table-sales-body');
            if (!tbody) return;
            tbody.innerHTML = sales.length ? '' : '<tr><td colspan="4" class="text-center py-4 text-gray-400">Belum ada penjualan</td></tr>';
            sales.forEach(s => {
                const date = s.timestamp?.toDate() ? s.timestamp.toDate().toLocaleTimeString('id-ID', {hour:'2-digit', minute:'2-digit'}) : '-';
                tbody.innerHTML += `
                    <tr class="border-b">
                        <td class="p-3 text-xs text-gray-500">${date}</td>
                        <td class="p-3 font-bold">${s.storeName}</td>
                        <td class="p-3 text-right font-bold text-blue-600">Rp ${s.totalOmzet.toLocaleString('id-ID')}</td>
                        <td class="p-3 text-center"><button onclick="deleteSale('${s.id}')" class="text-red-300"><i data-lucide="trash-2" size="14"></i></button></td>
                    </tr>`;
            });
            safeCreateIcons();
        }

        window.deleteSale = async (id) => {
            if (confirm("Hapus catatan penjualan ini?")) {
                await deleteDoc(doc(db, 'artifacts', appId, 'users', currentUser.uid, 'sales', id));
            }
        };

        function renderProfitReport() {
            const tbody = document.getElementById('table-profit-body');
            const summary = document.getElementById('profit-summary');
            if (!tbody) return;

            let totalOmzet = 0;
            let totalModal = 0;
            const itemMap = {};

            sales.forEach(sale => {
                sale.items.forEach(item => {
                    if (!itemMap[item.productId]) {
                        itemMap[item.productId] = { nama: item.nama, qty: 0, retur: 0, omzet: 0, modal: 0 };
                    }
                    const data = itemMap[item.productId];
                    data.qty += item.qty;
                    data.retur += item.retur;
                    data.omzet += item.subtotal;
                    data.modal += (item.qty - item.retur) * (item.hargaBeli || 0);
                    
                    totalOmzet += item.subtotal;
                    totalModal += (item.qty - item.retur) * (item.hargaBeli || 0);
                });
            });

            const totalLaba = totalOmzet - totalModal;
            summary.innerHTML = `
                <div class="bg-blue-50 p-3 rounded-lg"><p class="text-[10px] text-blue-600 font-bold uppercase">Omzet</p><p class="font-bold">Rp ${totalOmzet.toLocaleString('id-ID')}</p></div>
                <div class="bg-red-50 p-3 rounded-lg"><p class="text-[10px] text-red-600 font-bold uppercase">Modal</p><p class="font-bold">Rp ${totalModal.toLocaleString('id-ID')}</p></div>
                <div class="bg-green-50 p-3 rounded-lg"><p class="text-[10px] text-green-600 font-bold uppercase">Laba</p><p class="font-bold">Rp ${totalLaba.toLocaleString('id-ID')}</p></div>
            `;

            tbody.innerHTML = '';
            Object.values(itemMap).forEach(data => {
                const laba = data.omzet - data.modal;
                tbody.innerHTML += `
                    <tr class="border-b">
                        <td class="p-3">
                            <p class="font-bold">${data.nama}</p>
                            <p class="text-[10px] text-gray-500">Laku: ${data.qty-data.retur} (Rtr: ${data.retur})</p>
                        </td>
                        <td class="p-3 text-right">Rp ${data.omzet.toLocaleString('id-ID')}</td>
                        <td class="p-3 text-right font-bold text-green-600">Rp ${laba.toLocaleString('id-ID')}</td>
                    </tr>`;
            });
        }

        function updateStats() {
            const today = new Date().toLocaleDateString('id-ID');
            const todaySales = sales.filter(s => s.timestamp?.toDate()?.toLocaleDateString('id-ID') === today);
            const totalOmzet = todaySales.reduce((sum, s) => sum + s.totalOmzet, 0);
            const uniqueStores = new Set(todaySales.map(s => s.storeId)).size;

            document.getElementById('stat-omzet').innerText = `Rp ${totalOmzet.toLocaleString('id-ID')}`;
            document.getElementById('stat-toko').innerText = uniqueStores;
        }

        // --- MASTER DATA ---
        function renderStores() {
            const tbody = document.getElementById('table-toko-body');
            if (!tbody) return;
            tbody.innerHTML = stores.length ? '' : '<tr><td colspan="3" class="text-center py-4 text-gray-400 italic">Belum ada toko</td></tr>';
            stores.forEach(t => {
                tbody.innerHTML += `<tr class="border-b"><td class="px-4 py-3 font-bold">${t.nama}</td><td class="px-4 py-3 text-xs text-gray-500">${t.alamat || ''}</td><td class="px-4 py-3 text-center flex justify-center gap-2"><button onclick="prepareEditStore('${t.id}')" class="text-blue-500"><i data-lucide="edit-3" size="16"></i></button><button onclick="deleteStore('${t.id}')" class="text-red-400"><i data-lucide="trash-2" size="16"></i></button></td></tr>`;
            });
            safeCreateIcons();
        }

        window.prepareEditStore = (id) => {
            const s = stores.find(st => st.id === id);
            document.getElementById('toko-nama').value = s.nama;
            document.getElementById('toko-alamat').value = s.alamat || '';
            editingStoreId = id;
        };

        window.deleteStore = async (id) => {
            if (confirm("Hapus toko ini?")) await deleteDoc(doc(db, 'artifacts', appId, 'users', currentUser.uid, 'stores', id));
        };

        function renderProducts() {
            const tbody = document.getElementById('table-produk-body');
            if (!tbody) return;
            tbody.innerHTML = products.length ? '' : '<tr><td colspan="4" class="text-center py-4 text-gray-400 italic">Belum ada produk</td></tr>';
            products.forEach(p => {
                tbody.innerHTML += `<tr class="border-b"><td class="px-4 py-3 font-bold">${p.nama}</td><td class="px-4 py-3">Rp ${p.hargaBeli.toLocaleString('id-ID')}</td><td class="px-4 py-3 text-blue-600 font-semibold">Rp ${p.harga.toLocaleString('id-ID')}</td><td class="px-4 py-3 text-center flex justify-center gap-2"><button onclick="prepareEditProduct('${p.id}')" class="text-blue-500"><i data-lucide="edit-3" size="16"></i></button><button onclick="deleteProduct('${p.id}')" class="text-red-400"><i data-lucide="trash-2" size="16"></i></button></td></tr>`;
            });
            safeCreateIcons();
        }

        window.prepareEditProduct = (id) => {
            const p = products.find(pr => pr.id === id);
            document.getElementById('prod-nama').value = p.nama;
            document.getElementById('prod-harga-beli').value = p.hargaBeli;
            document.getElementById('prod-harga').value = p.harga;
            editingProductId = id;
        };

        window.deleteProduct = async (id) => {
            if (confirm("Hapus produk ini?")) await deleteDoc(doc(db, 'artifacts', appId, 'users', currentUser.uid, 'products', id));
        };

        function updateDropdowns() {
            const st = document.getElementById('select-toko');
            if (st) {
                st.innerHTML = '<option value="">-- Pilih Toko --</option>';
                stores.sort((a,b)=>a.nama.localeCompare(b.nama)).forEach(t => st.innerHTML += `<option value="${t.id}">${t.nama}</option>`);
            }

            const sp = document.getElementById('select-produk');
            if (sp) {
                sp.innerHTML = '<option value="">-- Pilih Produk --</option>';
                products.forEach(p => sp.innerHTML += `<option value="${p.id}">${p.nama}</option>`);
            }

            const bp = document.getElementById('buy-product');
            if (bp) {
                bp.innerHTML = '<option value="">-- Pilih Produk --</option>';
                products.forEach(p => bp.innerHTML += `<option value="${p.id}">${p.nama}</option>`);
            }
        }

        window.handleStoreSubmit = async (e) => { 
            e.preventDefault(); 
            const nama = document.getElementById('toko-nama').value; 
            const alamat = document.getElementById('toko-alamat').value; 
            if(editingStoreId) { 
                await updateDoc(doc(db, 'artifacts', appId, 'users', currentUser.uid, 'stores', editingStoreId), {nama, alamat}); 
                editingStoreId = null; 
            } else { 
                await addDoc(collection(db, 'artifacts', appId, 'users', currentUser.uid, 'stores'), {nama, alamat}); 
            } 
            document.getElementById('form-toko').reset(); 
        };

        window.handleProductSubmit = async (e) => { 
            e.preventDefault(); 
            const nama = document.getElementById('prod-nama').value; 
            const hargaBeli = parseInt(document.getElementById('prod-harga-beli').value); 
            const harga = parseInt(document.getElementById('prod-harga').value); 
            if(editingProductId) { 
                await updateDoc(doc(db, 'artifacts', appId, 'users', currentUser.uid, 'products', editingProductId), {nama, hargaBeli, harga}); 
                editingProductId = null; 
            } else { 
                await addDoc(collection(db, 'artifacts', appId, 'users', currentUser.uid, 'products'), {nama, hargaBeli, harga}); 
            } 
            document.getElementById('form-produk').reset(); 
        };

        window.showToast = (m) => { 
            const t = document.getElementById('notification'); 
            t.innerText = m; 
            t.classList.remove('hidden'); 
            setTimeout(()=>t.classList.add('hidden'), 2000); 
        };

        window.onload = () => {
            initAuth();
            document.getElementById('form-pembelian').onsubmit = handlePurchaseSubmit;
            document.getElementById('form-transaksi').onsubmit = addItemToTransaction;
            document.getElementById('form-toko').onsubmit = handleStoreSubmit;
            document.getElementById('form-produk').onsubmit = handleProductSubmit;
        };
    </script>

    <style>
        body { font-family: 'Inter', sans-serif; -webkit-tap-highlight-color: transparent; }
        .nav-active { color: #2563eb; border-top: 3px solid #2563eb; background: #f8fafc; }
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        .table-container { overflow-x: auto; -webkit-overflow-scrolling: touch; }
    </style>
</head>
<body class="bg-gray-50 pb-28">

    <header class="bg-blue-600 text-white p-4 sticky top-0 z-10 shadow-md flex justify-between items-center">
        <h1 class="text-xl font-bold flex items-center gap-2"><i data-lucide="truck"></i> Jualan App</h1>
        <div id="user-id-display" class="text-[8px] opacity-60"></div>
    </header>

    <div class="max-w-4xl mx-auto p-4">
        
        <!-- Dashboard -->
        <section id="tab-dashboard" class="tab-content active">
            <h2 class="text-lg font-semibold mb-4">Ringkasan Hari Ini</h2>
            <div class="grid grid-cols-2 gap-4 mb-6">
                <div class="bg-white p-4 rounded-xl shadow-sm border-l-4 border-blue-500">
                    <p class="text-[10px] text-gray-400 uppercase font-bold">Omzet</p>
                    <p id="stat-omzet" class="text-lg font-bold">Rp 0</p>
                </div>
                <div class="bg-white p-4 rounded-xl shadow-sm border-l-4 border-green-500">
                    <p class="text-[10px] text-gray-400 uppercase font-bold">Toko</p>
                    <p id="stat-toko" class="text-lg font-bold">0</p>
                </div>
            </div>
            
            <h2 class="text-sm font-bold text-gray-500 uppercase mb-2">Aktivitas Terakhir</h2>
            <div class="bg-white rounded-xl shadow-sm border overflow-hidden table-container">
                <table class="w-full text-left">
                    <tbody id="table-sales-body" class="divide-y"></tbody>
                </table>
            </div>
        </section>

        <!-- Menu Pembelian (STOK MASUK) -->
        <section id="tab-pembelian" class="tab-content">
            <h2 class="text-lg font-semibold mb-4 text-gray-700">Input Stok Masuk (Pembelian)</h2>
            <div class="bg-white p-5 rounded-xl shadow-sm border border-gray-100 mb-6">
                <form id="form-pembelian" class="space-y-4">
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div>
                            <label class="block text-xs font-bold text-gray-500 uppercase mb-1">Pilih Produk</label>
                            <select id="buy-product" class="w-full p-2 border rounded-lg bg-gray-50 outline-none" required></select>
                        </div>
                        <div>
                            <label class="block text-xs font-bold text-gray-500 uppercase mb-1">Jumlah (Qty)</label>
                            <input type="number" id="buy-qty" placeholder="0" class="w-full p-2 border rounded-lg outline-none" required>
                        </div>
                        <div>
                            <label class="block text-xs font-bold text-gray-500 uppercase mb-1">Harga Beli Unit</label>
                            <input type="number" id="buy-price" placeholder="Rp" class="w-full p-2 border rounded-lg outline-none" required>
                        </div>
                    </div>
                    <button type="submit" class="w-full bg-indigo-600 text-white py-3 rounded-lg font-bold shadow-lg flex justify-center items-center gap-2">
                        <i data-lucide="download"></i> Simpan Pembelian
                    </button>
                </form>
            </div>

            <div class="bg-white rounded-xl shadow-sm border border-gray-100 table-container">
                <table class="w-full text-left text-sm">
                    <thead class="bg-gray-50 font-bold border-b">
                        <tr>
                            <th class="px-4 py-3">Tgl</th>
                            <th class="px-4 py-3">Produk</th>
                            <th class="px-4 py-3 text-center">Qty</th>
                            <th class="px-4 py-3 text-right">Satuan</th>
                            <th class="px-4 py-3 text-right">Total</th>
                            <th class="px-4 py-3 text-center"></th>
                        </tr>
                    </thead>
                    <tbody id="table-pembelian-body" class="divide-y"></tbody>
                </table>
            </div>
        </section>

        <!-- Menu Jualan (STOK KELUAR) -->
        <section id="tab-input" class="tab-content">
             <h2 class="text-lg font-semibold mb-4">Input Penjualan Toko</h2>
             <div class="bg-white p-5 rounded-xl shadow-sm border border-gray-100 mb-6">
                <form id="form-transaksi" class="space-y-4">
                    <select id="select-toko" class="w-full p-2 border rounded-lg" required></select>
                    <select id="select-produk" class="w-full p-2 border rounded-lg"></select>
                    <div class="grid grid-cols-2 gap-4">
                        <input type="number" id="input-qty" placeholder="Qty Jual" class="p-2 border rounded-lg">
                        <input type="number" id="input-retur" placeholder="Qty Retur" class="p-2 border rounded-lg bg-red-50">
                    </div>
                    <button type="submit" class="w-full bg-blue-600 text-white py-2 rounded-lg font-bold">+ Tambah Item</button>
                </form>

                <div id="transaction-preview" class="mt-6 border-t pt-4 hidden">
                    <h3 class="font-bold text-sm mb-2">Draft Nota:</h3>
                    <table class="w-full text-sm mb-4">
                        <tbody id="preview-body"></tbody>
                    </table>
                    <button onclick="submitTransaction()" class="w-full bg-green-600 text-white py-3 rounded-xl font-bold">SIMPAN PENJUALAN</button>
                </div>
             </div>
        </section>

        <!-- Laporan Laba Rugi -->
        <section id="tab-profit" class="tab-content">
            <h2 class="text-lg font-semibold mb-4">Analisis Laba Rugi</h2>
            <div id="profit-summary" class="grid grid-cols-3 gap-2 mb-6 text-center"></div>
            <div class="bg-white rounded-xl shadow-sm border overflow-hidden table-container">
                <table class="w-full text-sm text-left">
                    <thead class="bg-gray-100 font-bold">
                        <tr><th class="p-3">Item</th><th class="p-3 text-right">Omzet</th><th class="p-3 text-right">Laba</th></tr>
                    </thead>
                    <tbody id="table-profit-body"></tbody>
                </table>
            </div>
        </section>

        <!-- Tab Master -->
        <section id="tab-toko" class="tab-content">
            <h2 class="font-bold mb-4">Daftar Toko</h2>
            <form id="form-toko" class="mb-4 flex gap-2">
                <input id="toko-nama" placeholder="Nama Toko" class="flex-1 p-2 border rounded">
                <input id="toko-alamat" placeholder="Alamat (Opsional)" class="hidden">
                <button class="bg-blue-600 text-white px-4 rounded">+</button>
            </form>
            <div class="bg-white border rounded shadow-sm table-container"><table class="w-full text-sm text-left"><tbody id="table-toko-body"></tbody></table></div>
        </section>

        <section id="tab-produk" class="tab-content">
            <h2 class="font-bold mb-4">Daftar Produk</h2>
            <form id="form-produk" class="space-y-2 mb-4">
                <input id="prod-nama" placeholder="Nama Produk" class="w-full p-2 border rounded">
                <div class="flex gap-2">
                    <input id="prod-harga-beli" type="number" placeholder="Harga Beli" class="w-full p-2 border rounded">
                    <input id="prod-harga" type="number" placeholder="Harga Jual" class="w-full p-2 border rounded">
                </div>
                <button class="w-full bg-green-600 text-white py-2 rounded">Simpan Produk</button>
            </form>
            <div class="bg-white border rounded shadow-sm table-container"><table class="w-full text-sm text-left"><tbody id="table-produk-body"></tbody></table></div>
        </section>

    </div>

    <!-- Navigasi Bawah -->
    <nav class="fixed bottom-0 left-0 right-0 bg-white border-t flex h-20 shadow-2xl z-20 overflow-x-auto px-2">
        <button onclick="switchTab('dashboard')" class="nav-btn flex-1 min-w-[60px] flex flex-col items-center justify-center gap-1 text-gray-400 nav-active" data-tab="dashboard">
            <i data-lucide="home" size="18"></i><span class="text-[9px]">Beranda</span>
        </button>
        <button onclick="switchTab('pembelian')" class="nav-btn flex-1 min-w-[60px] flex flex-col items-center justify-center gap-1 text-gray-400" data-tab="pembelian">
            <i data-lucide="shopping-bag" size="18"></i><span class="text-[9px]">Beli Stok</span>
        </button>
        <button onclick="switchTab('input')" class="nav-btn flex-1 min-w-[60px] flex flex-col items-center justify-center gap-1 text-gray-400" data-tab="input">
            <i data-lucide="send" size="18"></i><span class="text-[9px]">Jualan</span>
        </button>
        <button onclick="switchTab('profit')" class="nav-btn flex-1 min-w-[60px] flex flex-col items-center justify-center gap-1 text-gray-400" data-tab="profit">
            <i data-lucide="trending-up" size="18"></i><span class="text-[9px]">Laba</span>
        </button>
        <button onclick="switchTab('produk')" class="nav-btn flex-1 min-w-[60px] flex flex-col items-center justify-center gap-1 text-gray-400" data-tab="produk">
            <i data-lucide="package" size="18"></i><span class="text-[9px]">Produk</span>
        </button>
    </nav>

    <div id="notification" class="fixed top-5 left-1/2 -translate-x-1/2 bg-gray-800 text-white px-4 py-2 rounded-full text-xs hidden z-50"></div>

</body>
</html>
